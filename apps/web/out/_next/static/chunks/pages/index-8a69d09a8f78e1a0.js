(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{1761:e=>{e.exports={renderer:"Renderer_renderer__uc_W2","mute-button":"Renderer_mute-button__PnuEQ","css-output":"Renderer_css-output__lxgge","webgl-output":"Renderer_webgl-output__AqTdm"}},6931:e=>{e.exports={ui:"RendererUI_ui__JKBL1",cinematic:"RendererUI_cinematic__cDShJ","name-container":"RendererUI_name-container__4aecl","cinematic-container":"RendererUI_cinematic-container__vA6Rq","cinematic-instructions":"RendererUI_cinematic-instructions__UEbci","fade-out":"RendererUI_fade-out__bv7uz","fade-in":"RendererUI_fade-in__xCNUF","mute-button":"RendererUI_mute-button__UIKVJ","camera-button":"RendererUI_camera-button__JV2CW","time-is-done":"RendererUI_time-is-done__tUV_J","sound-container":"RendererUI_sound-container__SINlM","blinking-cursor":"RendererUI_blinking-cursor__ptEr4",blink:"RendererUI_blink__dfWxL"}},7363:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>eQ});var i=n(6029),s=n(5669),r=n.n(s),a=n(5729),o=n(6691),l=n(1761),c=n.n(l),h=n(4796);function u(e){return{ok:!0,value:e}}function d(e,t){e&&e.postMessage(t,"*")}let m=()=>/^((?!chrome|android).)*safari/i.test(navigator.userAgent),p=e=>e.preventDefault(),f=e=>{e.style.touchAction="none",e.addEventListener("touchstart",p),e.addEventListener("touchmove",p),e.addEventListener("touchend",p),e.addEventListener("touchcancel",p)},g=e=>{e.style.touchAction="initial",e.removeEventListener("touchstart",p),e.removeEventListener("touchmove",p),e.removeEventListener("touchend",p),e.removeEventListener("touchcancel",p)};function w(e,t,n){let i=0,s=!1;return!function r(){let a=e();t(a.slice(0,++i)),i<a.length&&!1===s&&setTimeout(r,n)}(),()=>{s=!0}}function v(e){return e.filter(e=>null!==e).join(" ")}function x(e){d(document.getElementById("operating-system-iframe").contentWindow,e)}var b=n(22),y=n(5265),C=n(3408),_=n(7741);let S={uniforms:{sourceTexture:{value:null},sourceDepthMap:{value:null},cutoutDepthMap:{value:null}},vertexShader:"out vec2 texCoord;\n\nvoid main() {\n    texCoord = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",fragmentShader:"uniform sampler2D sourceTexture;\nuniform sampler2D sourceDepthMap;\n\nuniform sampler2D cutoutDepthMap;\n\nin vec2 texCoord;\n\nlayout(location = 0) out vec4 diffuseColor;\n\nvoid main() {\n    float sourceDepth = 1.0 - texture2D(sourceDepthMap, texCoord).r;\n    float cutoutDepth = 1.0 - texture2D(cutoutDepthMap, texCoord).r;\n\n    bool isCutout = sourceDepth >= cutoutDepth;\n\n    if (isCutout) {\n        diffuseColor = texture2D(sourceTexture, texCoord);\n    } else {\n        diffuseColor = vec4(.0, .0, .0, .0);\n    }\n}\n"};class E extends _.o{render(e,t,n){e.setRenderTarget(this.sourceTarget),e.render(this.sourceScene,this.camera),e.setRenderTarget(this.sourceDepthTarget),e.render(this.sourceScene,this.camera),e.setRenderTarget(this.cutoutTarget),e.render(this.cutoutScene,this.camera),this.uniforms.sourceTexture.value=this.sourceTarget.texture,this.uniforms.sourceDepthMap.value=this.sourceDepthTexture,this.uniforms.cutoutDepthMap.value=this.cutoutDepthTexture,this.fsQuad.material=this.material,this.renderToScreen?e.setRenderTarget(null):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil)),this.fsQuad.render(e)}setSize(e,t){this.sourceTarget.setSize(e,t),this.cutoutTarget.setSize(e,t)}dispose(){this.material.dispose(),this.fsQuad.dispose()}constructor(e,t,n,i,s){super(),this.sourceDepthTarget=null,this.sourceScene=e,this.cutoutScene=t,this.camera=n,this.sourceTarget=new o.nWS(i,s,{depthBuffer:!0,samples:4}),this.sourceDepthTexture=new o.VCu(i,s,o.bkx),this.sourceDepthTarget=new o.nWS(i,s,{depthBuffer:!0,depthTexture:this.sourceDepthTexture,samples:0}),this.cutoutDepthTexture=new o.VCu(i,s,o.bkx),this.cutoutTarget=new o.nWS(i,s,{depthBuffer:!0,depthTexture:this.cutoutDepthTexture,samples:0}),this.uniforms=o.LlO.clone(S.uniforms),this.material=new o.BKk({defines:{},uniforms:this.uniforms,vertexShader:S.vertexShader,fragmentShader:S.fragmentShader,glslVersion:o.Wdf}),this.fsQuad=new _.F(this.material)}}var M=n(8616),D=n(2191);class T extends M.p{updateUniformResolution(e,t){let n=window.devicePixelRatio;this.material.uniforms.resolution.value.x=1/(e*n),this.material.uniforms.resolution.value.y=1/(t*n)}setSize(e,t){this.updateUniformResolution(e,t)}constructor(e,t){super(D.o),this.updateUniformResolution(e,t)}}var P=function(e){return e.CameraCollidable="camera_collidable",e}({}),L=n(4258);function j(e,t,n){return(1-n)*e+n*t}function O(e,t,n){let i=1-Math.pow(1-n,3);return(1-i)*e+i*t}class F{getTarget(){return this.target}getOrigin(){return this.origin}getCamera(){return this.camera}getScene(){return this.scene}getCutoutScene(){return this.cutoutScene}enableDamping(){this.dampingEnabled=!0}disableDamping(){this.dampingEnabled=!1}isCameraFollowEnabled(){return this.cameraFollowEnabled}enableCameraFollow(){this.isCameraFollowEnabled()||this.syncFollowPositionToTarget(),this.cameraFollowEnabled=!0}disableCameraFollow(){this.cameraFollowEnabled&&this.syncTargetToFollowPosition(),this.cameraFollowEnabled=!1}syncFollowPositionToTarget(){this.targetFollowPosition.copy(this.target),this.cameraFollowPosition.copy(this.target)}syncTargetToFollowPosition(){this.target.copy(this.targetFollowPosition)}enableCameraFollowLimitMovementSpeed(){this.cameraFollowLimitMovementSpeed=!0}disableCameraFollowLimitMovementSpeed(){this.cameraFollowLimitMovementSpeed=!1}setCameraFollowMaxMovementSpeed(e){this.cameraFollowMaxMovementSpeed=e}moveCameraForward(e){let t=e*Math.sin(this.spherical.theta),n=e*Math.cos(this.spherical.theta);this.panOffset.x-=t,this.panOffset.z-=n}moveToHeight(e){let t=this.target.y-e;this.moveCameraUp(t)}moveCameraUp(e){this.panOffset.y+=e}moveCameraLeft(e){let t=this.spherical.theta+(0,L.pu)(90),n=e*Math.sin(t),i=e*Math.cos(t);this.panOffset.x-=n,this.panOffset.z-=i}rotateCamera(e,t){this.enabled&&(this.sphericalDelta.phi-=e,this.sphericalDelta.theta-=t)}rotateCameraUp(e){this.enabled&&(this.sphericalDelta.phi-=e)}setRotationTheta(e){if(!this.enabled)return;let t=e-this.spherical.theta;this.sphericalDelta.theta=t}setRotationPhi(e){if(!this.enabled)return;let t=e-this.spherical.phi;this.sphericalDelta.phi=t}rotateCameraLeft(e){this.enabled&&(this.sphericalDelta.theta-=e)}autoZoom(e,t,n,i){let s=null!=n?n:j,r=0,a=this.currentZoomDistance,o=n=>{let o=Math.min((r+=1e3*n)/t,1);this.currentZoomDistance=s(a,e,o);let l=1===o;return l&&void 0!==i&&i(),{done:l,blocking:!1}};this.actions.push(o)}transition(e,t,n,i,s,r){let a=null!=s?s:j,o=0,l=this.cameraFollowEnabled?this.targetFollowPosition.clone():this.target.clone(),c=this.spherical.clone(),h=this.currentZoomDistance;this.setOriginToPosition(e);let u=s=>{o+=1e3*s;let u=0!==i?Math.min(o/i,1):1,d=a(l.x,e.x,u),m=a(l.y,e.y,u),p=a(l.z,e.z,u),f=a(c.phi,t.phi,u),g=a(c.theta,t.theta,u);this.panOffset.x=-(this.target.x-d),this.panOffset.y=-(this.target.y-m),this.panOffset.z=-(this.target.z-p),this.sphericalDelta.phi=-(this.spherical.phi-f),this.sphericalDelta.theta=-(this.spherical.theta-g),this.currentZoomDistance=j(h,n,u);let w=1===u;return w&&void 0!==r&&r(),{done:w,blocking:!0}};this.actions.push(u)}getPanOffset(){return this.panOffset}setPanOffsetX(e){this.panOffset.setX(e)}setPanOffsetY(e){this.panOffset.setY(e)}setPanOffsetZ(e){this.panOffset.setZ(e)}setMinZoom(e){this.minZoomDistance=e}getMinZoom(){return this.minZoomDistance}setMaxZoom(e){this.maxZoomDistance=e}getMaxZoom(){return this.maxZoomDistance}getZoom(){return this.currentZoomDistance}updateOrigin(){this.setOriginToPosition(this.target)}setOriginToPosition(e){this.origin.copy(e)}resetOriginBoundary(){this.setOriginBoundaryX(null),this.setOriginBoundaryY(null),this.setOriginBoundaryZ(null)}getOriginBoundaryX(){return this.originBoundaryX}setOriginBoundaryX(e){this.originBoundaryX=e}getOriginBoundaryY(){return this.originBoundaryY}setOriginBoundaryY(e){this.originBoundaryY=e}getOriginBoundaryZ(){return this.originBoundaryZ}setOriginBoundaryZ(e){this.originBoundaryZ=e}setZoom(e){this.currentZoomDistance=(0,L.qE)(e,this.minZoomDistance,this.maxZoomDistance)}zoom(e){let t=this.calculateRadiusLimit(this.currentZoomDistance)+e;this.currentZoomDistance=(0,L.qE)(t,this.minZoomDistance,this.maxZoomDistance)}isTransitioning(){return this.hasActions()}hasActions(){return this.actions.length>0}getAction(){return this.actions[0]}popAction(){return this.actions.shift()}processActions(e){if(!this.hasActions())return;let t=this.getAction()(e);this.enabled=!t.blocking,!0===t.done&&this.popAction(),!0!==t.done||this.hasActions()||(this.enabled=!0)}update(e){this.processActions(e);let t=this.dampingFactor,n=new o.Pq0;function i(e,t,n){let i=n<=t+e;return i&&n>=t-e?n:t+(i?-e:e)}if(n.copy(this.cameraPosition).sub(this.target),n.applyQuaternion(this.quat),this.spherical.setFromVector3(n),this.dampingEnabled?(this.spherical.theta+=this.sphericalDelta.theta*t,this.spherical.phi+=this.sphericalDelta.phi*t):(this.spherical.theta+=this.sphericalDelta.theta,this.spherical.phi+=this.sphericalDelta.phi),this.spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this.spherical.phi)),this.spherical.makeSafe(),this.spherical.radius=this.calculateRadiusLimit(this.currentZoomDistance),n.setFromSpherical(this.spherical),n.applyQuaternion(this.quatInverse),this.dampingEnabled?this.target.addScaledVector(this.panOffset,t):this.target.add(this.panOffset),this.originBoundaryX&&this.target.setX(i(this.originBoundaryX,this.origin.x,this.target.x)),this.originBoundaryY&&this.target.setY(i(this.originBoundaryY,this.origin.y,this.target.y)),this.originBoundaryZ&&this.target.setZ(i(this.originBoundaryZ,this.origin.z,this.target.z)),this.cameraFollowEnabled){let e=new o.Pq0;if(e.copy(this.target).sub(this.targetFollowPosition),this.cameraFollowLimitMovementSpeed){let t=this.cameraFollowMaxMovementSpeed;e.x=(0,L.qE)(e.x,-t,t),e.y=(0,L.qE)(e.y,-t,t),e.z=(0,L.qE)(e.z,-t,t)}e.multiplyScalar(this.cameraFollowDampingFactor),this.targetFollowPosition.add(e);let t=new o.Pq0;t.copy(this.targetFollowPosition).sub(this.cameraFollowPosition),t.multiplyScalar(this.cameraFollowDampingFactor),this.cameraFollowPosition.add(t),this.cameraPosition.copy(this.target).add(n),this.camera.position.copy(this.cameraFollowPosition).add(n),this.camera.lookAt(this.targetFollowPosition)}else this.cameraPosition.copy(this.target).add(n),this.camera.position.copy(this.cameraPosition),this.camera.lookAt(this.target);this.dampingEnabled?(this.sphericalDelta.theta*=1-t,this.sphericalDelta.phi*=1-t,this.panOffset.multiplyScalar(1-t)):(this.sphericalDelta.set(0,0,0),this.panOffset.set(0,0,0))}constructor(e,t,n){this.camera=e,this.scene=t,this.cutoutScene=n,this.actions=[],this.enabled=!0,this.target=new o.Pq0(0,0,0),this.cameraFollowEnabled=!1,this.cameraFollowLimitMovementSpeed=!0,this.cameraFollowMaxMovementSpeed=.35,this.cameraFollowDampingFactor=.05,this.targetFollowPosition=new o.Pq0(0,0,0),this.cameraFollowPosition=new o.Pq0(0,0,0),this.cameraPosition=new o.Pq0(0,0,0),this.dampingEnabled=!1,this.dampingFactor=.225,this.origin=new o.Pq0(0,0,0),this.originBoundaryX=null,this.originBoundaryY=null,this.originBoundaryZ=null,this.spherical=new o.YHV,this.sphericalDelta=new o.YHV,this.panOffset=new o.Pq0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI-(0,L.pu)(45),this.quat=new o.PTz().setFromUnitVectors(this.camera.up,new o.Pq0(0,1,0)),this.quatInverse=this.quat.clone().invert(),this.minZoomDistance=2.5,this.maxZoomDistance=15,this.currentZoomDistance=10,this.calculateRadiusLimit=(()=>{let e=new o.tBo,t=new o.YHV,n=new o.Pq0,i=(0,L.pu)(2.5),s=new o.tBo,r=new o.YHV,a=new o.Pq0,l=(0,L.pu)(2.5),c=e=>{for(let t=0;t<e.length;t++){let n=e[t];if(n.object.userData[P.CameraCollidable])return n}return null};return o=>{var h,u;e.far=o,s.far=o,t.copy(this.spherical).phi+=i,r.copy(this.spherical).phi-=l,n.setFromSpherical(t).normalize(),a.setFromSpherical(r).normalize(),e.set(this.target,n),s.set(this.target,a);let d=c(e.intersectObjects(this.scene.children)),m=c(s.intersectObjects(this.scene.children));return Math.min(null!=(h=null==d?void 0:d.distance)?h:o,null!=(u=null==m?void 0:m.distance)?u:o)}})()}}class B{static fromTouchData(e){if(e.hasTouchesDown(1)){let t=e.touches[0],n=t.x,i=t.y;return new B(n,i,n,i)}let t=e.touches.map(e=>e.x),n=e.touches.map(e=>e.y);return new B(Math.min(...t),Math.min(...n),Math.max(...t),Math.max(...n))}width(){return this.x2-this.x1}height(){return this.y2-this.y1}center(){return{x:this.x1+this.width()/2,y:this.y1+this.height()/2}}diagonal(){return Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))}constructor(e,t,n,i){this.x1=e,this.y1=t,this.x2=n,this.y2=i}}class k{subscribe(e){return this.handlers.push(e),()=>{this.unsubscribe(e)}}unsubscribe(e){this.handlers=this.handlers.filter(t=>t!==e)}emit(e){for(let t of this.handlers)t(e)}once(e){let t=n=>{e(n),this.unsubscribe(t)};this.subscribe(t)}constructor(){this.handlers=[]}}class I{static fromMouseData(e,t){let{x:n,y:i}=e.pointerCoordinates();return new I(n,i,t)}constructor(e,t,n){this.x=e,this.y=t,this.instruction=n}}class R{static fromTouchData(e,t,n,i){let s=e.pointerCoordinates();return new R(s.x,s.y,Date.now(),t,n,i)}constructor(e,t,n,i,s,r){this.x=e,this.y=t,this.creationTime=n,this.durationInMS=i,this.callbackSuccess=s,this.callbackCancelation=r}}class A{static fromMouseEvent(e,t){return new A(e,t.clientX,t.clientY,0,t.buttons)}static fromWheelEvent(e,t){return new A(e,t.clientX,t.clientY,t.deltaY,t.buttons)}isPrimaryDown(){return(1&this.buttons)>0}isSecondaryDown(){return(2&this.buttons)>0}zoomDelta(){return .01*this.deltaY}pointerCoordinates(){return{x:this.x,y:this.y}}constructor(e,t,n,i,s){this.source=e,this.x=t,this.y=n,this.deltaY=i,this.buttons=s}}class Z{static fromTouch(e){return new Z(e.clientX,e.clientY)}constructor(e,t){this.x=e,this.y=t}}class z{static fromTouchEvent(e,t){let n=[];for(let e of t.touches){let t=Z.fromTouch(e);n.push(t)}return new z(e,n,"self")}hasTouchesDown(e){return this.touches.length===e}hasMoreTouchesDownThan(e){return this.touches.length>e}boundingBox(){return B.fromTouchData(this)}pointerCoordinates(){let e=0,t=0,n=this.touches.length;for(let n of this.touches)e+=n.x,t+=n.y;return{x:e/n,y:t/n}}constructor(e,t,n){this.source=e,this.touches=t,this.origin=n}}let U=e=>({event:"touch_confirmation_event",data:e}),N=e=>({event:"mouse_confirmation_event",data:e}),q=()=>({event:"cancel_mouse_confirmation_event"}),H=e=>({event:"touch_event",data:e}),W=e=>({event:"mouse_event",data:e});class V{allowInput(){var e;return null!=(e=this.allowInputRef.current)&&e}create(){window.addEventListener("pointerdown",this.onPointerDownListener),window.addEventListener("pointerup",this.onPointerUpListener),window.addEventListener("pointermove",this.onPointerMoveListener),window.addEventListener("pointerleave",this.onPointerLeaveListener),window.addEventListener("contextmenu",this.onContextMenuListener),window.addEventListener("wheel",this.onWheelListener)}destroy(){window.removeEventListener("pointerdown",this.onPointerDownListener),window.removeEventListener("pointerup",this.onPointerUpListener),window.removeEventListener("pointermove",this.onPointerMoveListener),window.removeEventListener("pointerleave",this.onPointerLeaveListener),window.removeEventListener("contextmenu",this.onContextMenuListener),window.removeEventListener("wheel",this.onWheelListener)}dropPointerEvent(e){let t=!e.isPrimary,n="mouse"!==e.pointerType;return t||n}onPointerDown(e){if(!this.allowInput()||this.dropPointerEvent(e))return;let t=W(A.fromMouseEvent("down",e));this.handler.emitUserInteractionEvent(t)}onPointerUp(e){if(!this.allowInput()||this.dropPointerEvent(e))return;let t=W(A.fromMouseEvent("up",e));this.handler.emitUserInteractionEvent(t)}onPointerMove(e){if(!this.allowInput()||this.dropPointerEvent(e))return;let t=W(A.fromMouseEvent("move",e));this.handler.emitUserInteractionEvent(t)}onPointerLeave(e){if(!this.allowInput()||this.dropPointerEvent(e))return;let t=W(A.fromMouseEvent("leave",e));this.handler.emitUserInteractionEvent(t)}onContextMenu(e){this.allowInput()&&e.preventDefault()}onWheel(e){if(!this.allowInput())return;let t=W(A.fromWheelEvent("wheel",e));this.handler.emitUserInteractionEvent(t)}constructor(e,t){this.allowInputRef=e,this.handler=t,this.onPointerDownListener=this.onPointerDown.bind(this),this.onPointerUpListener=this.onPointerUp.bind(this),this.onPointerMoveListener=this.onPointerMove.bind(this),this.onPointerLeaveListener=this.onPointerLeave.bind(this),this.onContextMenuListener=this.onContextMenu.bind(this),this.onWheelListener=this.onWheel.bind(this),this.create()}}class Y{isTransitioning(){return this.ctx.cameraController.isTransitioning()}constructor(e,t){this.manager=e,this.ctx=t}}class X extends Y{}var G=n(3601);function J(e){let t="/htmaa2",n="".concat(t).concat(e);return console.log("getAssetPath (components): ".concat(e," -> ").concat(n,' (hardcoded prefix: "').concat(t,'")')),n}let K="DisplayParent",Q="Display";async function $(e,t){console.log("loadTexture called with: ".concat(t));let n=await e.textureLoader.loadAsync(t);return n.flipY=!1,n}async function ee(e,t){return console.log("loadModel called with: ".concat(t)),await e.gltfLoader.loadAsync(t)}function et(e){for(let t of e.scene.children)t.userData[P.CameraCollidable]=!0}function en(){return{downloader:null,builder:null,builderProcessTime:0}}let ei=e=>{let t=new o.tBo,n=new o.I9Y;return i=>{var s;n.x=i.x/window.innerWidth*2-1,n.y=-(2*(i.y/window.innerHeight))+1;let r=e.cameraController.getCamera();t.setFromCamera(n,r);let a=null!=(s=t.intersectObjects(e.cameraController.getCutoutScene().children)[0])?s:null;return null!==a&&"Display"===a.object.name}};function es(e){return e.hasTouchesDown(1)}function er(e){return e.hasTouchesDown(2)}class ea{static create(e,t){return new ea(t,e.getZoom())}constructor(e,t){this.touchData=e,this.zoomDistance=t}}function eo(e){return"rpc"===e.origin}let el=e=>{let t=e.children.find(e=>e.name===K);return null==t?void 0:t.children.find(e=>e.name===Q)};function ec(e,t){let n=0,i=document.elementFromPoint(e,t);do{if(!i)break;if("BUTTON"===i.tagName)return!0;i=i.parentElement}while(n++<5);return!1}class eh extends Y{transition(){var e;this.ctx.enableWebGLPointerEvents();let t=new o.Pq0;t.y=6.8;let n=new o.YHV;n.phi=1,n.theta=0,this.ctx.cameraController.enableDamping(),this.ctx.cameraController.disableCameraFollow(),this.ctx.cameraController.setMinZoom(2),this.ctx.cameraController.setMaxZoom(15),this.ctx.cameraController.setOriginBoundaryX(40),this.ctx.cameraController.setOriginBoundaryY(40),this.ctx.cameraController.setOriginBoundaryZ(null),this.ctx.cameraController.transition(t,n,10,500),null==(e=document.activeElement)||e.blur()}handleDisplayClick(e){this.isOverDisplay(e)&&(this.clearMouseInstruction(),this.manager.changeState(ef.MonitorView))}moveCamera(e){let t=0,n=0,i=this.previousMovementData;null!==i&&(t=(e.y-i.y)*.005,n=(e.x-i.x)*.005),this.ctx.cameraController.moveCameraForward(t),this.ctx.cameraController.moveCameraLeft(n),this.previousMovementData=e}clearMoveCamera(){this.previousMovementData=null}rotateCamera(e){let t=0,n=0,i=this.previousRotationData;null!==i&&(t=(e.y-i.y)*.01,n=(e.x-i.x)*.01),this.ctx.cameraController.rotateCamera(t,n),this.previousRotationData=e}updateCursor(e){this.ctx.setCursor(this.isOverDisplay(e)?"pointer":"auto")}clearRotateCamera(){this.previousRotationData=null}onUserEvent(e){switch(e.event){case"mouse_event":return this.handleMouseEvent(e.data);case"touch_event":return this.handleTouchEvent(e.data)}}handleMouseUp(e){this.clearMoveCamera(),this.clearRotateCamera()}handleMouseDown(e){e.isPrimaryDown()&&this.handleDisplayClick(e)}clearMouseInstruction(){let e=q();this.manager.emitUserInteractionEvent(e)}handleMouseInstruction(e){let t=this.isOverDisplay(e);if(t!==this.wasOverDisplay)if(t){let t=N(I.fromMouseData(e,"Click to zoom in"));this.manager.emitUserInteractionEvent(t)}else this.clearMouseInstruction();this.wasOverDisplay=t}handleMouseMove(e){e.isPrimaryDown()&&this.rotateCamera(e.pointerCoordinates()),e.isSecondaryDown()&&this.moveCamera(e.pointerCoordinates()),this.handleMouseInstruction(e),this.updateCursor(e)}handleMouseScroll(e){this.ctx.cameraController.zoom(e.zoomDelta())}handleMouseEvent(e){switch(e.source){case"up":return this.handleMouseUp(e);case"down":return this.handleMouseDown(e);case"move":return this.handleMouseMove(e);case"wheel":return this.handleMouseScroll(e)}}setupZoomEvent(e){er(e)?this.panOrigin=ea.create(this.ctx.cameraController,e):this.panOrigin=null}handleZoomEvent(e){if(null===this.panOrigin)return;let t=this.panOrigin.touchData.boundingBox(),n=e.boundingBox(),i=this.panOrigin.zoomDistance,s=(n.diagonal()-t.diagonal())*.01;this.ctx.cameraController.setZoom(i-s)}handleTouchDisplayClick(e){if(!this.isOverDisplay(e.pointerCoordinates()))return;let t=()=>{this.clearMouseInstruction(),this.manager.changeState(ef.MonitorView)},n=U(R.fromTouchData(e,800,t,null));this.manager.emitUserInteractionEvent(n)}handleTouchStart(e){es(e)&&this.handleTouchDisplayClick(e),this.setupZoomEvent(e),this.clearMoveCamera(),this.clearRotateCamera()}handleTouchMove(e){(e.hasTouchesDown(2)||e.hasTouchesDown(3))&&this.moveCamera(e.pointerCoordinates()),e.hasTouchesDown(1)&&this.rotateCamera(e.pointerCoordinates()),er(e)&&this.handleZoomEvent(e)}handleTouchEnd(e){this.clearMoveCamera(),this.clearRotateCamera()}handleTouchEvent(e){switch(e.source){case"start":return this.handleTouchStart(e);case"move":return this.handleTouchMove(e);case"end":return this.handleTouchEnd(e)}}constructor(e,t){super(e,t),this.previousMovementData=null,this.previousRotationData=null,this.panOrigin=null,this.wasOverDisplay=!1,this.isOverDisplay=ei(this.ctx)}}class eu extends Y{transition(){let e=el(this.ctx.scene);if(!e)return;let{spherical:t,position:n,distance:i}=((e,t,n)=>{let i=e.geometry.boundingBox,s=i.max.x-i.min.x,r=i.max.y-i.min.y,a=i.max.z-i.min.z,l=new o.Pq0(i.min.x+s/2,i.min.y+r/2,i.min.z+a/2),c=new o.Pq0;c.add(e.position),c.add(l);let h=new o.YHV;h.phi=Math.atan2(r,a),new o.Pq0().setFromSpherical(h);let u=Math.tan((0,L.pu)(t/2)),[d,m]=[window.innerWidth,window.innerHeight];return{spherical:h,position:c,distance:u*(s/2+n/(d/m))}})(e,this.ctx.cameraController.getCamera().fov,2.4),s=()=>{this.ctx.disableWebGLPointerEvents(),this.ctx.cameraController.setOriginBoundaryX(2),this.ctx.cameraController.setOriginBoundaryY(1.5),document.getElementById("operating-system-iframe").focus()};this.ctx.cameraController.enableDamping(),this.ctx.cameraController.transition(n,t,i,1250/i,L.Cc,s),this.ctx.cameraController.setMinZoom(1),this.ctx.cameraController.setMaxZoom(5),this.ctx.cameraController.setOriginBoundaryX(null),this.ctx.cameraController.setOriginBoundaryY(null)}setupZoomEvent(e){er(e)?this.panOrigin=ea.create(this.ctx.cameraController,e):this.panOrigin=null}handleZoomEvent(e){if(null===this.panOrigin)return;let t=this.panOrigin.touchData.boundingBox(),n=e.boundingBox(),i=this.panOrigin.zoomDistance,s=(n.diagonal()-t.diagonal())*.01;this.ctx.cameraController.setZoom(i+s)}updateCursor(e){let t=this.isOverDisplay(e),n=()=>t!==this.wasOverDisplay,i=ec(e.x,e.y);if(t||i){this.ctx.disableWebGLPointerEvents(),this.ctx.setCursor("auto");let e=q();this.manager.emitUserInteractionEvent(e)}else if(this.ctx.enableWebGLPointerEvents(),this.ctx.setCursor("pointer"),n()){let t=N(I.fromMouseData(e,"Click to zoom out"));this.manager.emitUserInteractionEvent(t)}this.wasOverDisplay=t}onUserEvent(e){switch(e.event){case"mouse_event":return this.handleMouseEvent(e.data);case"touch_event":return this.handleTouchEvent(e.data)}}handleMouseDown(e){var t,n,i;if(t=e.isPrimaryDown(),n=e.x,i=e.y,t&&ec(n,i)||this.isOverDisplay(e))return;let s=q();this.manager.emitUserInteractionEvent(s),this.manager.changeState(ef.FreeRoam)}handleMouseMove(e){this.updateCursor(e)}handleMouseEvent(e){switch(e.source){case"down":return this.handleMouseDown(e);case"move":return this.handleMouseMove(e)}}handleTouchOutsideDisplay(e){var t,n,i;let s=e.pointerCoordinates();if(t=e.hasTouchesDown(1),n=s.x,i=s.y,t&&ec(n,i))return;let r=()=>{this.manager.changeState(ef.FreeRoam)},a=U(R.fromTouchData(e,800,r,null));this.manager.emitUserInteractionEvent(a)}handleOwnOriginTouchStart(e){es(e)&&this.handleTouchOutsideDisplay(e)}handleRpcOriginTouchStart(e){this.setupZoomEvent(e)}handleTouchEvent(e){"start"===e.source&&"self"===e.origin&&this.handleOwnOriginTouchStart(e),"start"===e.source&&eo(e)&&this.handleRpcOriginTouchStart(e),"move"===e.source&&eo(e)&&this.handleZoomEvent(e)}constructor(e,t){super(e,t),this.panOrigin=null,this.wasOverDisplay=!1,this.isOverDisplay=ei(this.ctx)}}function ed(e){e.setPanOffsetY(7),e.setPanOffsetZ(3),e.update(0)}class em extends X{transition(){if(!el(this.ctx.scene))return;this.ctx.isInitialScene()&&ed(this.ctx.cameraController);let e=new o.Pq0;e.y=6.8;let t=new o.YHV;t.phi=1,t.theta=this.calculateRotation(0);let n=this.ctx.isInitialScene()?this.initialTransitionMs:this.otherTransitionsMs;this.ctx.cameraController.transition(e,t,10,n,O,()=>{this.progress=0}),this.ctx.setCursor("pointer")}calculateRotation(e){e%=100;let t=(0,L.pu)(-30),n=(0,L.pu)(30),i=e<50,s=-(Math.cos(Math.PI*(i?e/50:(e-50)/50))-1)/2,r=n-t;return i?t+r*s:n-r*s}update(e){this.progress+=this.cameraRotationSpeed*e,this.ctx.cameraController.setRotationTheta(this.calculateRotation(this.progress)),this.progress%=100}onUserEvent(e){switch(e.event){case"mouse_event":return this.handleMouseEvent(e.data);case"touch_event":return this.handleTouchEvent(e.data)}}toggleHasBeenOverDisplay(e){e&&(this.wasOverDisplay||(this.hasBeenOverDisplay=!0))}handleOverMonitor(e){let t=this.isOverDisplay(e);this.toggleHasBeenOverDisplay(t),t&&this.hasBeenOverDisplay&&this.manager.changeState(ef.MonitorView),this.wasOverDisplay=t}handleMouseClickEvent(e){if(e.isPrimaryDown()){var t,n,i;t=!0,n=e.x,i=e.y,t&&ec(n,i)||this.manager.changeState(ef.MonitorView)}}handleMouseEvent(e){this.handleOverMonitor(e),this.handleMouseClickEvent(e)}handleTouchStartEvents(e){var t,n,i;let s=e.pointerCoordinates();t=e.hasTouchesDown(1),n=s.x,i=s.y,t&&ec(n,i)||this.manager.changeState(ef.MonitorView)}handleTouchEvent(e){"start"===e.source&&this.handleTouchStartEvents(e)}constructor(e,t){super(e,t),this.cameraRotationSpeed=7.5,this.initialTransitionMs=2e3,this.otherTransitionsMs=500,this.hasBeenOverDisplay=!1,this.wasOverDisplay=!0,this.progress=0,this.isOverDisplay=ei(this.ctx)}}class ep{get cameraController(){return this._cameraController}get webglNode(){return this._webglNode}get scene(){return this._cameraController.getScene()}transitionScene(){this.initialScene=!1}isInitialScene(){return this.initialScene}setCursor(e){this._webglNode.style.cursor=e}enableWebGLPointerEvents(){this._webglNode.style.pointerEvents="auto"}disableWebGLPointerEvents(){this._webglNode.style.pointerEvents="none"}constructor(e,t){this._cameraController=e,this._webglNode=t,this.initialScene=!0}}var ef=function(e){return e[e.FreeRoam=0]="FreeRoam",e[e.MonitorView=1]="MonitorView",e[e.Cinematic=2]="Cinematic",e}({});class eg{destroy(){this.userInteractionEventBusUnsubscribeHandler()}stateToInstance(e){switch(e){case 0:return new eh(this,this.ctx);case 1:return new eu(this,this.ctx);case 2:return new em(this,this.ctx);default:throw Error("unsupported state")}}getContext(){return this.ctx}changeState(e){!this.state.isTransitioning()&&(this.getContext().setCursor("default"),this.state=this.stateToInstance(e),this.state.transition(),this.getContext().transitionScene(),this.onChangeState&&this.onChangeState(e))}emitUserInteractionEvent(e){this.userInteractionEventBus.emit(e)}onUserInteractionEvent(e){this.state.onUserEvent(e)}update(e){this.state instanceof X&&this.state.update(e)}constructor(e,t,n,i){this.userInteractionEventBus=n,this.onChangeState=i,this.ctx=new ep(e,t),this.state=this.stateToInstance(2),this.state.transition(),this.userInteractionEventBusUnsubscribeHandler=this.userInteractionEventBus.subscribe(this.onUserInteractionEvent.bind(this))}}class ew{allowInput(){var e;return null!=(e=this.allowInputRef.current)&&e}create(){window.addEventListener("touchstart",this.onTouchStartListener),window.addEventListener("touchmove",this.onTouchMoveListener),window.addEventListener("touchend",this.onTouchEndListener)}destroy(){window.removeEventListener("touchstart",this.onTouchStartListener),window.removeEventListener("touchmove",this.onTouchMoveListener),window.removeEventListener("touchend",this.onTouchEndListener)}onTouchStart(e){if(!this.allowInput())return;let t=H(z.fromTouchEvent("start",e));this.handler.emitUserInteractionEvent(t)}onTouchMove(e){if(!this.allowInput())return;let t=H(z.fromTouchEvent("move",e));this.handler.emitUserInteractionEvent(t)}onTouchEnd(e){if(!this.allowInput())return;let t=H(z.fromTouchEvent("end",e));this.handler.emitUserInteractionEvent(t)}constructor(e,t){this.allowInputRef=e,this.handler=t,this.onTouchStartListener=this.onTouchStart.bind(this),this.onTouchMoveListener=this.onTouchMove.bind(this),this.onTouchEndListener=this.onTouchEnd.bind(this),this.create()}}class ev{static fromConfirmationData(e){return new ev(e.x,e.y,e.instruction)}constructor(e,t,n){this.x=e,this.y=t,this.instruction=n}}class ex{static fromConfirmationData(e,t){return new ex(e.x,e.y,t)}constructor(e,t,n){this.x=e,this.y=t,this.progress=n}}var eb=n(6931),ey=n.n(eb);function eC(e){let{isSoundEnabled:t,toggleSound:n}=e.sound;return(0,i.jsx)("button",{className:ey()["mute-button"],onClick:()=>n(),children:(0,i.jsx)("img",{draggable:!1,src:t?"/htmaa2/icons/mute-icon.svg":"/htmaa2/icons/unmute-icon.svg",width:25,height:20})})}function e_(e){let{targetState:t,cameraHandler:n}=e;return(0,i.jsx)("button",{className:ey()["camera-button"],onClick:()=>void(n.current&&n.current.changeState(t)),children:(0,i.jsx)("img",{draggable:!1,src:"/htmaa2/icons/camera.svg",width:25,height:20})})}function eS(e){let{state:t,cameraHandler:n,sound:s}=e,r=(0,a.useRef)(!0),[o,l]=(0,a.useState)(""),[c,h]=(0,a.useState)(""),[u,d]=(0,a.useState)(""),[m,p]=(0,a.useState)(!1),f=t===ef.FreeRoam;function g(e){let t=String(e.getHours()).padStart(2,"0"),n=String(e.getMinutes()).padStart(2,"0"),i=String(e.getSeconds()).padStart(2,"0");return"".concat(t,":").concat(n,":").concat(i)}return(0,a.useEffect)(()=>{if(f&&r.current){function e(e,t,n){setTimeout(()=>w(e,t,35),35*n)}let t="Hayley Bloch",n="Fabrication Enthusiast";e(()=>t,l,0),e(()=>n,h,t.length+1),e(()=>g(new Date),d,t.length+n.length+2);let i=(8+t.length+n.length+2)*35;setTimeout(()=>{setInterval(()=>{d(g(new Date))},1e3)},i),setTimeout(()=>{p(!0)},i+35),r.current=!1}},[t]),(0,i.jsxs)("div",{className:v([ey()["name-container"],f?ey()["fade-in"]:ey()["fade-out"]]),children:[(0,i.jsx)("div",{children:o&&(0,i.jsx)("span",{children:o})}),(0,i.jsx)("div",{children:c&&(0,i.jsx)("span",{children:c})}),(0,i.jsxs)("div",{children:[u&&(0,i.jsx)("span",{className:"".concat(m?ey()["time-is-done"]:""),children:u}),m&&(0,i.jsx)(eC,{sound:s}),m&&(0,i.jsx)(e_,{targetState:ef.MonitorView,cameraHandler:n})]})]})}function eE(e){let{state:t,cameraHandler:n,sound:s}=e,r=t===ef.Cinematic||t===ef.MonitorView;return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:v([ey()["sound-container"],r?null:ey()["fade-out"]]),children:[(0,i.jsx)(eC,{sound:s}),(0,i.jsx)(e_,{targetState:t===ef.Cinematic?ef.MonitorView:ef.Cinematic,cameraHandler:n})]})})}function eM(e){let{state:t}=e,[n,s]=(0,a.useState)(""),r=t===ef.Cinematic;return(0,a.useEffect)(()=>{if(!r)return;let e=w(()=>"Click anywhere to start",s,35);return()=>{e()}},[t]),(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("div",{className:ey()["cinematic-container"],children:(0,i.jsxs)("span",{className:v([ey()["cinematic-instructions"],r?null:ey()["fade-out"]]),children:[n,(0,i.jsx)("span",{className:ey()["blinking-cursor"]})]})})})}function eD(e){let{cameraHandlerState:t,cameraHandler:n,soundService:s}=e,r=function(e){let[t,n]=(0,a.useState)(!0);function i(){n(!0),e.enable()}function s(){n(!1),e.disable()}return{isSoundEnabled:t,toggleSound:function(){t?s():i()},enableSound:i,disableSound:s}}(s);return(0,i.jsxs)("div",{className:ey().ui,children:[(0,i.jsx)(eE,{state:t,cameraHandler:n,sound:r}),(0,i.jsx)(eS,{state:t,cameraHandler:n,sound:r}),(0,i.jsx)(eM,{state:t,sound:r})]})}class eT{notifyOtherWebpage(e){x({method:"enable_sound_message",enabled:e})}notify(e){for(let t of this.observers)t(e)}enable(){this.enabled=!0,this.notify(this.enabled),this.notifyOtherWebpage(this.enabled)}disable(){this.enabled=!1,this.notify(this.enabled),this.notifyOtherWebpage(this.enabled)}mute(e){var t;let n=null!=(t=this.activeAudio[e])?t:null;n&&(n.muted=!0)}unmute(e){var t;let n=null!=(t=this.activeAudio[e])?t:null;n&&(n.muted=!1)}volume(e,t){var n;let i=null!=(n=this.activeAudio[e])?n:null;i&&(i.volume=t)}muteAll(){for(let e of this.activeAudio.keys())this.mute(e)}unmuteAll(){for(let e of this.activeAudio.keys())this.unmute(e)}stop(e){var t;let n=null!=(t=this.activeAudio[e])?t:null;n&&(n.pause(),delete this.activeAudio[e])}clear(){this.index=0,this.activeAudio=[]}play(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.index++,i=new Audio(e);return i.volume=t,i.muted=!this.enabled,i.play(),this.activeAudio[n]=i,i.addEventListener("ended",()=>{delete this.activeAudio[n]}),n}playOnRepeat(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.index++,i=new Audio(e);return i.volume=t,i.muted=!this.enabled,i.play(),this.activeAudio[n]=i,i.addEventListener("ended",()=>{var e;null==(e=this.activeAudio[n])||e.play()}),n}subscribe(e){return this.observers.push(e),()=>{this.unsubscribe(e)}}unsubscribe(e){for(let[t,n]of this.observers.entries())if(n===e)return void this.observers.splice(t)}constructor(){this.observers=[],this.enabled=!1,this.index=0,this.activeAudio=[]}}function eP(e){let{cameraHandlerState:t,soundService:n}=e,s=(0,a.useRef)(!1);return(0,a.useEffect)(()=>()=>{},[]),(0,a.useEffect)(()=>{s.current=t===ef.MonitorView},[t]),(0,i.jsx)(i.Fragment,{})}function eL(){return new URLSearchParams(window.location.search).has("debug")}function ej(){return window.innerWidth<500}function eO(){let e=window.innerWidth,t=window.innerHeight;return m()&&(1&e&&e++,1&t&&t++),[e,t]}async function eF(e){return new Promise(t=>setTimeout(t,e))}var eB=n(3544);let ek=e=>{let[t,n]=(0,a.useState)(ef.Cinematic),s=(0,a.useRef)(new eT),{loading:r,showMessage:l,scenes:p,actions:w}=e,v=(0,a.useRef)(null),_=(0,a.useRef)(null),S=(0,a.useRef)(null),M=(0,a.useRef)(!1),[D,P]=(0,a.useState)(!1),L=new k,j=(e=>{let[t,n]=(0,a.useState)(null),s=null;function r(e){switch(e.event){case"mouse_event":var t=e.data;if(!s)return;let i=s;i.x=t.x,i.y=t.y;return;case"mouse_confirmation_event":return void(s=e.data);case"cancel_mouse_confirmation_event":return void(s=null,n(null))}}function o(){s&&n(ev.fromConfirmationData(s))}return((0,a.useEffect)(()=>{let t=e.subscribe(r),n=setInterval(o,.25);return()=>{t(),clearInterval(n)}},[]),null===t)?(0,i.jsx)(i.Fragment,{}):function(e){let t={top:e.y+-40,left:e.x+-40,zIndex:1e4,padding:"8px",position:"fixed",color:"#fff",background:"#000",userSelect:"none",pointerEvents:"none",fontFamily:"Metropolis Medium",whiteSpace:"nowrap"};return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("div",{style:t,children:e.instruction})})}(t)})(L),O=(e=>{let[t,n]=(0,a.useState)(null),s=null;function r(){s=null,n(null)}function o(){(null==s?void 0:s.callbackCancelation)!==null&&(null==s||s.callbackCancelation()),r()}function l(e){switch(e.event){case"touch_event":var t;return void((t=e.data).hasMoreTouchesDownThan(1)&&o(),!function(e){if(null===s)return!1;let[t,n]=[s.x,s.y],{x:i,y:r}=e.pointerCoordinates(),a=Math.abs(n-r);return 25>Math.abs(t-i)&&a<25}(t)&&o());case"touch_confirmation_event":var i=e.data;s=i,n(ex.fromConfirmationData(i,0));return}}function c(){if(null===s)return;let e=Math.min((Date.now()-s.creationTime)/s.durationInMS,1);n(ex.fromConfirmationData(s,e)),1===e&&(null==s||s.callbackSuccess(),r())}return((0,a.useEffect)(()=>{let t=e.subscribe(l),n=setInterval(c,.25);return()=>{t(),clearInterval(n)}},[]),null===t)?(0,i.jsx)(i.Fragment,{}):function(e){let[t,n]=[e.x,e.y],s=Math.max(Math.min(1,e.progress),0),r=2*Math.PI*50;return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("div",{style:{top:n-70,left:t-70,height:140,width:140,position:"absolute",userSelect:"none",WebkitUserSelect:"none",touchAction:"none"},children:(0,i.jsxs)("svg",{width:140,height:140,viewBox:"0 0 ".concat(140," ").concat(140),style:{transform:"rotate(-90deg)"},children:[(0,i.jsx)("circle",{r:50,cx:70,cy:70,fill:"transparent",stroke:"#ffffff",strokeWidth:"".concat(20,"px")}),(0,i.jsx)("circle",{r:50,cx:70,cy:70,fill:"transparent",stroke:"#99e550",strokeWidth:"".concat(20,"px"),strokeDasharray:"".concat(r,"px"),strokeDashoffset:"".concat(r*(1-s),"px")})]})})})}(t)})(L),B=(0,a.useRef)(null);function I(e){n(e)}return(0,a.useEffect)(()=>{let e,t,n,i=v.current,s=_.current,r=eL();if(null==i||null==s)return;let a=null,l=new eB.A,[c,D]=eO(),[P,j,O]=[p.sourceScene,p.cutoutScene,p.cssScene],k=((e,t)=>{let n=new o.ubm(e,t,.1,1e3);return n.position.z=5,n})(75,c/D),[R,A]=function(e,t){let n=new h.JeP({antialias:!0,alpha:!1,powerPreference:"high-performance"});n.shadowMap.enabled=!0,n.shadowMap.type=o.RyA;let i=new b.a0;return n.setSize(e,t),i.setSize(e,t),[n,i]}(c,D);R.setPixelRatio(window.devicePixelRatio),f(i),f(s);let Z=new F(k,P,j),z=new eg(Z,s,L,I),U=new V(M,z),N=new ew(M,z);S.current=z;let q=function(e){let t=function(e){var t;switch(null!=(t=e.data.method)?t:null){case"camera_zoom_distance_request":return u({method:"camera_zoom_distance_request"});case"set_possible_camera_parameters_request":return u({method:"set_possible_camera_parameters_request",currentZoom:e.data.currentZoom,horizontalOffset:e.data.horizontalOffset,verticalOffset:e.data.verticalOffset});case"set_camera_parameters_request":return u({method:"set_camera_parameters_request",currentZoom:e.data.currentZoom,horizontalOffset:e.data.horizontalOffset,verticalOffset:e.data.verticalOffset});case"touch_interaction_request":return u({method:"touch_interaction_request",data:e.data.data});case"mounted":return u({method:"mounted"});default:return{ok:!1,error:Error("Not a deserializable data structure")}}}(e);if(!t.ok)return;let n=t.value,i=z.getContext().cameraController;switch(n.method){case"set_possible_camera_parameters_request":i.getMinZoom(),i.getMaxZoom(),n.currentZoom;break;case"camera_zoom_distance_request":{let t=i.getMinZoom(),n=i.getMaxZoom(),s=i.getZoom();d(e.source,{method:"camera_zoom_distance_response",max_distance:n,min_distance:t,current_distance:s,max_horizontal_offset:10,horizontal_offset:0,max_vertical_offset:10,vertical_offset:0})}break;case"set_camera_parameters_request":{let e=n.currentZoom;i.setZoom(e),i.setPanOffsetX(n.horizontalOffset),i.setPanOffsetY(n.verticalOffset)}break;case"mounted":d(e.source,{method:"display_size",width:window.innerWidth,height:window.innerHeight})}},H=(e=R,t=c,n=D,new y.s(e,((e,t,n)=>new o.nWS(t,n,{minFilter:o.k6q,magFilter:o.k6q,format:o.GWd,depthTexture:new o.VCu(t,n)}))(0,t,n))),W=new E(P,j,k,c,D);H.addPass(W);let Y=new C.F(P,k);Y.resolution.set(128,128),Y.params.saoBias=100,Y.params.saoIntensity=3e-4,Y.params.saoBlur=!1,H.addPass(Y);let X=new T(c,D);H.addPass(X),i.appendChild(A.domElement),s.appendChild(R.domElement),r&&s.appendChild(l.dom);let G=function(e){null==B.current&&(B.current=e);let t=(e-B.current)*.001;for(let n of(B.current=e,a=requestAnimationFrame(G),r&&l.begin(),w))n(t);H.render(),k.matrixWorldAutoUpdate=!1,k.updateMatrixWorld(),m()&&(k.matrixWorldInverse.elements[15]=-1),A.render(O,k),k.matrixWorldAutoUpdate=!0,Z.update(t),z.update(t),r&&l.end()},J=function(){let[e,t]=eO();H.setSize(e,t),R.setSize(e,t),A.setSize(e,t),k.aspect=e/t,k.updateProjectionMatrix(),x({method:"display_size",width:window.innerWidth,height:window.innerHeight})},K=function(){a&&cancelAnimationFrame(a),g(i),g(s),R.dispose(),R.forceContextLoss(),U.destroy(),N.destroy(),z.destroy(),i.removeChild(A.domElement),s.removeChild(R.domElement),window.removeEventListener("resize",J,!1),window.removeEventListener("message",q,!1)};return window.addEventListener("resize",J,!1),window.addEventListener("message",q,!1),G(performance.now()),()=>K()},[]),(0,a.useEffect)(()=>{l||(M.current=!0,P(!0),S.current.changeState(ef.Cinematic))},[l]),(0,a.useEffect)(()=>{r||ed(S.current.getContext().cameraController)},[r]),(0,i.jsxs)("div",{className:c().renderer,children:[D&&(0,i.jsx)(eD,{cameraHandlerState:t,cameraHandler:S,soundService:s.current}),(0,i.jsx)("div",{className:c()["css-output"],ref:v}),(0,i.jsx)("div",{className:c()["webgl-output"],ref:_}),j,O,(0,i.jsx)(eP,{cameraHandlerState:t,soundService:s.current})]})};var eI=n(9497),eR=n(317);class eA{constructor(e,t,n,i,s){this.debug=e,this.renderer=t,this.textureLoader=n,this.gltfLoader=i,this.scenes=s}}class eZ{progress(){return{loaded:this.listLoadedEntries().length,total:this.listAllEntries().length}}listAllEntries(){return this.entries}listLoadedEntries(){return this.entries.filter(e=>e.downloaded&&e.processed)}listTotalProgressPerLoadedEntry(e){let t=this.listLoadedEntries(),n=100/this.entries.length,i=t.map((e,t)=>({entry:e,total:n*(t+1)}));if(e){let t=i.length-e,n=i.length;return i.slice(t,n)}return i}isDoneLoading(){return this.listLoadedEntries().length===this.listAllEntries().length}constructor(e){this.entries=e}}class ez{init(e){let t=new o.Tap(this.loadingManager),n=new eI.B(this.loadingManager),i=new eR.Z;i.setDecoderPath("https://cdn.jsdelivr.net/npm/three@0.178.0/examples/jsm/libs/draco/"),n.setDRACOLoader(i);let s=new h.JeP;this.context=new eA(e,s,t,n,this.rendererScenes)}setDebug(e){this.context&&(this.context.debug=e)}getRenderScenes(){var e,t;return null!=(t=null==(e=this.context)?void 0:e.scenes)?t:null}add(e,t){let n=null===t.downloader,i=null===t.builder;this.assets[e]={name:e,assetLoader:t,inScene:!1,order:this.index++,downloaded:n,processed:i}}reset(){let e=this.rendererScenes;this.index=0,this.assets={},e.sourceScene.clear(),e.cutoutScene.clear(),e.cssScene.clear()}loadingProgress(){return new eZ(Object.values(this.assets).sort((e,t)=>e.order-t.order).map(e=>({name:e.name,downloaded:e.downloaded,processed:e.processed})))}async load(e,t){this.context||this.init(!1);let n=[],i=Object.values(this.assets).map(e=>(async()=>{let n=e.assetLoader.downloader;n&&!e.downloaded&&(await n(this.context),e.downloaded=!0,t&&t())})());for(let s of(await Promise.all(i),Object.values(this.assets).sort((e,t)=>e.order-t.order))){let i=s.assetLoader.builder;if(s.inScene||!i)continue;if(s.assetLoader.builderProcessTime&&await eF(s.assetLoader.builderProcessTime),e&&e.aborted)return{updateActions:[]};let r=i(this.context);if(s.processed=!0,r)for(let e of r)n.push(e);t&&t()}return{updateActions:n}}constructor(e,t){this.rendererScenes=e,this.loadingManager=t,this.context=null,this.index=0,this.assets={}}}var eU=n(8186),eN=n.n(eU);function eq(e,t){var n;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"\xa0",s=Math.max(0,t-1-(null!=(n=null==e?void 0:e.length)?n:0));return i.repeat(s)+"\xa0"}function eH(e){let t=Number(e.downloaded)+Number(e.processed),n="".concat(e.name," (").concat(t,"/").concat(2,")");return(0,i.jsxs)("li",{style:{fontFamily:"monospace"},"aria-label":n,children:[e.name,eq(e.name,30,"."),"(",t,"/",2,")"]},"".concat(e.name,"-").concat(+!!e.downloaded,"-").concat(+!!e.processed))}function eW(){let e="Hayley Bloch",t="HTMAA HAYLEY BLOCH",n=new Date().getFullYear();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:eN().bold,children:e}),eq(e,16),(0,i.jsxs)("span",{children:["Released: September ",n]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:eN().bold,children:t}),eq(t,16),(0,i.jsxs)("span",{children:["HTMAA \xa9 ",n," Hayley Bloch"]})]}),(0,i.jsx)("br",{})]})}function eV(e){let{onClick:t}=e,[n,s]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{let e=()=>s(ej());e();let t=null,n=()=>{t&&cancelAnimationFrame(t),t=requestAnimationFrame(e)};return window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n),t&&cancelAnimationFrame(t)}},[]),(0,i.jsx)("div",{className:eN()["user-message"],children:(0,i.jsx)("div",{className:eN()["user-message-position-container"],children:(0,i.jsxs)("div",{className:eN()["user-message-container"],children:[(0,i.jsx)("h1",{children:"Portfolio of Hayley Bloch"}),n&&(0,i.jsx)("p",{className:eN().warning,children:"WARNING: This portfolio is best experienced on a desktop, laptop, or a tablet computer"}),(0,i.jsxs)("p",{children:[(0,i.jsx)("span",{className:eN()["continue-text"],children:"Click continue to begin"}),(0,i.jsx)("span",{className:eN()["blinking-cursor"]})]}),(0,i.jsx)("div",{className:eN()["button-center-container"],children:(0,i.jsx)("button",{onClick:t,autoFocus:!0,"aria-label":"Continue to portfolio",children:"Continue"})})]})})})}function eY(){let e="Melchior, Magi 1",t="Balthasar, Magi 2",n="Casper, Magi 3";return(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{children:"Magi, Hayleysoft, bv, 1998 to 2024"}),(0,i.jsx)("h3",{children:"Components"}),(0,i.jsxs)("ul",{children:[(0,i.jsxs)("li",{children:[e,eq(e,30,"."),"Linked"]}),(0,i.jsxs)("li",{children:[t,eq(t,30,"."),"Linked"]}),(0,i.jsxs)("li",{children:[n,eq(n,30,"."),"Linked"]})]})]})}function eX(){return(0,i.jsx)("div",{className:eN()["loading-underscore"],children:(0,i.jsx)("span",{className:eN()["blinking-cursor"]})})}function eG(){return null}function eJ(){let[e,t]=(0,a.useState)(!0),[n,s]=(0,a.useState)(!0),[r,l]=(0,a.useState)(!0),[c,h]=(0,a.useState)(!0),u=(0,a.useRef)(function(){let e=new o.Z58;return e.background=new o.Q1f(0xfefefe),{sourceScene:e,cutoutScene:new o.Z58,cssScene:new o.Z58}}()),d=(0,a.useRef)(null),p=(0,a.useRef)([]),[f,g]=(0,a.useState)(null),[w,v]=(0,a.useState)(null);return((0,a.useEffect)(()=>{let e,n,i,s,r,a,l,c,h,f,w,x,y,C,_,S,E,M,D,T=function(){var e=document.createElement("canvas");let t=e.getContext("webgl")||e.getContext("experimental-webgl");return!!t&&t instanceof WebGLRenderingContext}();if(v(T),!T)return;d.current=new ez(u.current,new o.KPJ);let j=d.current;j.init(eL()),j.reset(),[["Linked to Magi 1",en()],["Linked to Magi 2",en()],["Linked to Magi 3",en()],["Loading desk",(e=null,n=null,{downloader:async function t(t){let i=async()=>{n=await $(t,J("//htmaa2//htmaa2//htmaa2/assets/Desk.jpg"))},s=async()=>{e=await ee(t,J("//htmaa2//htmaa2//htmaa2/assets/Desk.glb"))};await Promise.all([i(),s()])},builder:function(t){if(!n||!e)return null;for(let t of e.scene.children)t.userData[P.CameraCollidable]=!0;let i=new o.G_z({map:n,color:0xf0f0f0});return e.scene.traverse(e=>{e instanceof o.eaF&&("Desk"===e.name&&(e.material=i),e.receiveShadow=!0)}),t.scenes.sourceScene.add(e.scene),null},builderProcessTime:0})],["Loading cables",(i=null,{downloader:async function e(e){i=await ee(e,J("//htmaa2//htmaa2//htmaa2/assets/Cables.gltf"))},builder:function(e){if(!i)return null;let t=new o.V9B({color:3158064});return i.scene.traverse(e=>{e instanceof o.eaF&&(e.material=t)}),e.scenes.sourceScene.add(i.scene),null},builderProcessTime:0})],["Loading mouse",(s=null,r=null,{downloader:async function e(e){let t=async()=>{s=await $(e,J("//htmaa2//htmaa2//htmaa2/assets/Mouse.jpg"))},n=async()=>{r=await ee(e,J("//htmaa2//htmaa2//htmaa2/assets/Mouse.glb"))};await Promise.all([t(),n()])},builder:function(e){if(!r||!s)return null;let t=new o.V9B({map:s});return r.scene.traverse(e=>{e instanceof o.eaF&&(e.material=t)}),e.scenes.sourceScene.add(r.scene),null},builderProcessTime:0})],["Loading lights",{downloader:null,builder:function(e){let t=new o.$p8(4210752);t.intensity=4,e.scenes.sourceScene.add(t);let n=new o.ZyN(0xffffff,.3);return n.position.set(8,12,3),n.target.position.set(5,0,-1),n.castShadow=!0,n.shadow.mapSize.width=1024,n.shadow.mapSize.height=1024,n.shadow.camera.near=.5,n.shadow.camera.far=50,n.shadow.camera.left=-15,n.shadow.camera.right=15,n.shadow.camera.top=15,n.shadow.camera.bottom=-15,n.shadow.bias=-1e-4,n.shadow.radius=10,e.scenes.sourceScene.add(n),e.scenes.sourceScene.add(n.target),null},builderProcessTime:0}],["Loading floor",(a=null,l=null,{downloader:async function e(e){let t=async()=>{l=await $(e,J("//htmaa2//htmaa2//htmaa2/assets/SmoothFloor.jpg"))},n=async()=>{a=await ee(e,J("//htmaa2//htmaa2//htmaa2/assets/SmoothFloor.glb"))};await Promise.all([t(),n()])},builder:function(e){if(!l||!a)return null;et(a),e.scenes.sourceScene.add(a.scene);let t=new o.V9B({map:l});return a.scene.traverse(e=>{e instanceof o.eaF&&(e.material=t,e.receiveShadow=!0)}),null},builderProcessTime:0})],["Loading plant",(c=null,h=null,{downloader:async function e(e){let t=async()=>{c=await ee(e,J("//htmaa2//htmaa2//htmaa2/assets/Plant.glb"))},n=async()=>{h=await $(e,J("//htmaa2//htmaa2//htmaa2/assets/Plant.jpg"))};await Promise.all([t(),n()])},builder:function(e){if(!c)return null;let t=new o.V9B({map:h});return c.scene.traverse(e=>{e instanceof o.eaF&&(e.material=t)}),e.scenes.sourceScene.add(c.scene),null},builderProcessTime:0})],["Loading Bust",(f=null,w=null,{downloader:async function e(e){let t=async()=>{f=await ee(e,J("//htmaa2//htmaa2//htmaa2/assets/Bust.glb"))},n=async()=>{w=await $(e,J("//htmaa2//htmaa2//htmaa2/assets/Bust.jpg"))};await Promise.all([t(),n()])},builder:function(e){if(!f)return null;let t=new o.V9B({map:w});return f.scene.traverse(e=>{e instanceof o.eaF&&(e.material=t,e.material.side=o.$EB,e.castShadow=!0,e.receiveShadow=!0)}),f.scene.position.set(5.5,7,-1.2),f.scene.rotation.y=Math.PI/.75,f.scene.scale.setScalar(.35),e.scenes.sourceScene.add(f.scene),null},builderProcessTime:0})],["Loading iris",(x=null,{downloader:async function e(e){let t=async()=>{x=await ee(e,J("//htmaa2//htmaa2//htmaa2/assets/Iris.glb"))};await Promise.all([t()])},builder:function(e){if(!x)return null;let t=new o.V9B({color:0xf0cda9});x.scene.traverse(e=>{e instanceof o.eaF&&(e.material=t,e.castShadow=!0,e.receiveShadow=!0)}),x.scene.position.set(-5,5.9,.5),x.scene.rotation.y=Math.PI/4,x.scene.scale.setScalar(.01);let n=new o.$p8(0xffffff,.3);return n.position.copy(x.scene.position),e.scenes.sourceScene.add(n),e.scenes.sourceScene.add(x.scene),null},builderProcessTime:0})],["Loading keyboard",(C=null,_=null,{downloader:async function e(e){let t=async()=>{C=await $(e,J("//htmaa2//htmaa2//htmaa2/assets/KeyboardCase.jpg"))},n=async()=>{_=await $(e,J("//htmaa2//htmaa2//htmaa2/assets/KeyboardKeyCaps.jpg"))},i=async()=>{y=await ee(e,J("//htmaa2//htmaa2//htmaa2/assets/Keyboard.glb"))};await Promise.all([t(),n(),i()])},builder:function(e){if(!y||!C||!_)return null;et(y);let t=new o.V9B({map:C}),n=new o.V9B({map:_});return y.scene.traverse(e=>{e instanceof o.eaF&&("Case"===e.name?e.material=t:e.material=n)}),e.scenes.sourceScene.add(y.scene),null},builderProcessTime:0})],["Loading monitor",(E=null,M=null,D=null,{downloader:async function e(e){let t=async()=>{E=await $(e,J("//htmaa2//htmaa2//htmaa2/assets/Monitor.jpg"))},n=async()=>{M=await $(e,J("//htmaa2//htmaa2//htmaa2/assets/Computer.jpg"))},i=async()=>{D=await $(e,J("//htmaa2//htmaa2//htmaa2/assets/NamePlate.jpg"))},s=async()=>{S=await ee(e,J("//htmaa2//htmaa2//htmaa2/assets/Monitor.glb"))};await Promise.all([t(),n(),i(),s()])},builder:function(e){var t;if(!S||!E||!M)return null;S.scene.name=K;let n=new o.V9B({color:0});n.stencilWrite=!0,n.transparent=!0;let i=new o.V9B({map:E}),s=new o.V9B({map:M}),r=new o.V9B({map:D});S.scene.traverse(e=>{if(e instanceof o.eaF)switch(e.name){case Q:e.material=n;break;case"Monitor":e.material=i;break;case"Computer":e.material=s;break;case"NamePlate":e.material=r}});let a=S.scene.children.find(e=>e.name===Q),l=a.clone();a.visible=!1;let c=null!=(t=a.geometry.boundingBox)?t:new o.NRn,h=m()?.2:.1,u=c.max.x-c.min.x+h,d=.765625*u,p=c.max.z-c.min.z,f=Math.sqrt(Math.pow(p,2)+Math.pow(d,2)),g=document.createElement("div");g.style.width="".concat(1280,"px"),g.style.height="".concat(980,"px");let w=document.createElement("iframe");w.id="operating-system-iframe",w.classList.add("iframe-container"),w.style.width="100%",w.style.height="100%",w.style.backgroundColor="black",w.style.boxSizing="border-box",w.style.padding="32px",w.src=function(e){let t=function(){var e;let t=G.env.NEXT_PUBLIC_DESKTOP_URL;return t||(null!=(e=G.env.NEXT_PUBLIC_TARGET_URL)?e:"http://127.0.0.1:3001/")}();return e?"".concat(t,"/?debug"):t}(e.debug),g.appendChild(w);let v=new b.on(g),[x,y,C]=[c.min.x-h/2+u/2,c.min.y-h/2+d/2,c.min.z+p/2],[_,T,P]=[l.position.x+x,l.position.y+y,l.position.z+C];return v.position.set(_,T,P),v.scale.set(u/1280,f/980,1),v.rotateX(Math.atan(d/p)-(0,L.pu)(90)),e.scenes.cssScene.add(v),e.scenes.sourceScene.add(S.scene),e.scenes.cutoutScene.add(l),null},builderProcessTime:250})]].forEach(e=>{let[t,n]=e;return j.add(t,n)}),g(j.loadingProgress());let O=new AbortController;return(async()=>{let{updateActions:e}=await j.load(O.signal,()=>{g(j.loadingProgress())});O.signal.aborted||(p.current=e,t(!1))})(),()=>O.abort()},[]),(0,a.useEffect)(()=>{f&&f.isDoneLoading()&&(eL()?(l(!1),s(!1),h(!1)):(setTimeout(()=>s(!1),50),setTimeout(()=>{h(!1),ej()||l(!1)},400)))},[f]),null===w)?(0,i.jsx)(i.Fragment,{}):!1===w?(0,i.jsxs)("div",{className:eN()["loading-progress"],children:[(0,i.jsx)(eW,{}),(0,i.jsxs)("div",{className:eN()["error-container"],children:[(0,i.jsx)("h3",{children:"ERROR: No WebGL detected"}),(0,i.jsx)("p",{children:"WebGL is required to run this site."}),(0,i.jsx)("p",{children:"Please enable it or switch to a browser that supports WebGL."})]})]}):(0,i.jsxs)(i.Fragment,{children:[n&&f&&(0,i.jsxs)("div",{className:eN()["loading-progress"],children:[(0,i.jsx)(eW,{}),(0,i.jsx)(eY,{}),function(e){let t=e.listAllEntries(),n=function(e){let{loaded:t,total:n}=e.progress(),s=n>0?Math.floor(t/n*100):0;return(0,i.jsxs)("div",{"aria-live":"polite","aria-atomic":"true",children:[(0,i.jsx)("h3",{style:{marginBottom:8},children:t===n?"Finished loading resources":"Loading resources (".concat(t,"/").concat(n,") ").concat(s,"%")}),(0,i.jsx)("div",{style:{height:6,width:280,background:"rgba(255,255,255,0.2)",borderRadius:3},children:(0,i.jsx)("div",{style:{height:"100%",width:"".concat(s,"%"),background:"white",borderRadius:3}})})]})}(e),s=t.map(eH);return(0,i.jsxs)("div",{children:[n,(0,i.jsx)("ul",{children:s})]})}(f),(0,i.jsx)(eG,{})]}),c&&(0,i.jsx)(eX,{}),r&&(0,i.jsx)(eV,{onClick:()=>l(!1)}),(0,i.jsx)(ek,{loading:e,showMessage:r,scenes:u.current,actions:p.current})]})}function eK(){return(0,i.jsxs)("noscript",{children:[(0,i.jsx)("style",{children:"\n    html, body {\n      height: 100vh;\n      width: 100vw;\n      margin: 0;\n      padding: 0;\n      background: #000;\n    }\n\n    noscript {\n      height: 100vh;\n      width: 100vw;\n      display: block;\n      background: #000;\n      margin: 0;\n      padding: 10px;\n      color: #fff;\n      font-family: monospace;\n      font-size: 1.2em;\n      box-sizing: border-box;\n    }\n\n    .bold {\n      font-weight: bold;\n      display: block;\n    }\n\n    p {\n      display: block;\n    }\n\n    h3 {\n      color: red;\n    }\n\n    a {\n      color: lightblue;\n    }\n  "}),(0,i.jsx)("span",{className:"bold",children:"Hayley Bloch"}),(0,i.jsx)("h3",{children:"ERROR: No JS detected"}),(0,i.jsx)("p",{children:"Javascript is required for this website to work."})]})}function eQ(){let[e,t]=(0,a.useState)("Hayley Bloch - Portfolio");function n(){t((document.visibilityState,"Hayley Bloch - Portfolio"))}return(0,a.useEffect)(()=>(document.addEventListener("visibilitychange",n),()=>{document.removeEventListener("visibilitychange",n)}),[]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(r(),{children:[(0,i.jsx)("title",{children:e}),(0,i.jsx)("meta",{name:"description",content:"Hayley Bloch - HTMAA student at MIT exploring digital fabrication, electronics, and creative engineering"}),(0,i.jsx)("meta",{property:"og:title",content:"Hayley Bloch - HTMAA Portfolio"}),(0,i.jsx)("meta",{property:"og:description",content:"MIT HTMAA student showcasing digital fabrication projects, electronics, and creative engineering work"}),(0,i.jsx)("meta",{property:"og:type",content:"website"}),(0,i.jsx)("meta",{property:"og:image",content:"https://hayleybloch.github.io/htmaa2//htmaa2//htmaa2//htmaa2/assets/thumbnail.png"}),(0,i.jsx)("meta",{property:"og:url",content:"https://hayleybloch.github.io/htmaa2/"}),(0,i.jsx)("meta",{property:"twitter:image",content:"https://hayleybloch.github.io/htmaa2//htmaa2//htmaa2//htmaa2/assets/thumbnail.png"}),(0,i.jsx)("meta",{property:"twitter:card",content:"summary_large_image"}),(0,i.jsx)("meta",{property:"twitter:title",content:"Hayley Bloch - HTMAA Portfolio"}),(0,i.jsx)("meta",{property:"twitter:description",content:"MIT HTMAA student showcasing digital fabrication projects, electronics, and creative engineering work"}),(0,i.jsx)("meta",{property:"og:site_name",content:"Hayley Bloch's portfolio"}),(0,i.jsx)("link",{rel:"icon",type:"image/x-icon",href:"favicon.ico"})]}),(0,i.jsx)(eK,{}),(0,i.jsx)(eJ,{})]})}},7703:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(7363)}])},8186:e=>{e.exports={"loading-progress":"SceneLoader_loading-progress__FQ2kc","loading-underscore":"SceneLoader_loading-underscore__mHCWj",bold:"SceneLoader_bold__mELB4","error-container":"SceneLoader_error-container__sSg8U",error:"SceneLoader_error__W46ZK","user-message":"SceneLoader_user-message__REedC","user-message-position-container":"SceneLoader_user-message-position-container__K6fGJ","user-message-container":"SceneLoader_user-message-container__Q6PMm","continue-text":"SceneLoader_continue-text__nBnrH","button-center-container":"SceneLoader_button-center-container__P7CzE",warning:"SceneLoader_warning__Mx9hJ","blinking-cursor":"SceneLoader_blinking-cursor__i8SFD",blink:"SceneLoader_blink__8RmYC"}}},e=>{e.O(0,[391,334,940,636,593,792],()=>e(e.s=7703)),_N_E=e.O()}]);